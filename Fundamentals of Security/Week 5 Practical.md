# RSA: Key Generation

### Calculating phi(n) for n = 43 * 

p = 43, q = 67, e = 65

n = pq = 43 * 67 = 2881

É¸(n) = (p - 1)(q - 1) = 42 * 66 = 2772

e = 65

| Iteration | a    | b    | Division        | eq(r = a + _ * b)      |
| --------- | ---- | ---- | --------------- | ---------------------- |
| 1         | 2772 | 65   | a = 42 * b + 42 | 42 = 2772 + (-42) * 65 |
| 2         | 65   | 42   | a = 1 * b + 23  | 23 = 65 + (-1) * 42    |
| 3         | 42   | 23   | a = 1 * b + 19  | 19 = 42 + (-1) * 23    |
| 4         | 23   | 19   | a = 1 * b + 4   | 4 = 23 + (-1) * 19     |
| 5         | 19   | 4    | a = 4 * b + 3   | 3 = 4 + (-1) * 3       |
| 6         | 4    | 3    | a = 1 * b + 1   | 1 = 4 + (-1) * 3       |
| 7         | 3    | 1    | a = 3 * b + 0   |                        |

Hence:

1 = 4 + (-1) * 3

1 = 4 + (-1) * (19 + (-4) * 4) = 4 + (-1) * 19 + 4 * 4 = (-1) * 19 + 5 * 4

1 = (-1) * 19 + 5 * (23 + (-1) * 19) = (-1) * 19 + 5 * 23 + (-5) * 19 = 5 * 23 + (-6) * 19

1 = 5 * 23 + (-6) * (42 + (-1) * 23) = 5 * 23 + (-6) * 42 + (6) * 23 = (-6) * 42 + 11 * 23

1 = (-6) * 42 + 11 * (65 + (-1) * 42) = (-6) * 42 + 11 * 65 + (-11) * 42 = 11 * 65 + (-17) * 42

1 = 11 * 65 + (-17) * (2772 + (-42) * 65) = 11 * 65 + (-17) * 2772 + (714) * 65 = (-17) * 2772 + (725) * 65

Hence (725 * 65) mod 2772 = 1 and thus d = 725

PU = {e, n}, PR = {d, n}

PU = {65, 2881} and PR = {725, 2881}

# Eulers Theorem

a^(phi(n) - 1) CONGRUENT a^(-1)(mod n)

- not feasible in practice as numbers will become very large

# RSA: Encryption

15^65 mod 2881

- 15^65 = 15^32 * 15^32 * 15^1 = 45990015 mod 2881 = 612
- 15^32 = 15^16